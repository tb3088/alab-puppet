---
# umask values *must* be converted to String since Puppet library function symbolic_mode_to_int() et. al.
# throw errors if int.to_i(8) is not successful. use function os::mode() to convert.
# Once my patches are in this nonsense goes away, and can use '0o####' format. 
# NOTE '0####' is *long* deprecated (2000) out of YAML, Python, Perl and should not be used.

os::separator:
  file: '/'
  path: ':'

os::default:
  shell:    '/bin/bash'
  # expire:
  directory: &default_directory
    owner:  0
    group:  0
    # Puppet 4.10 is till broken and demands string
    mode:   '0755'
    ensure: directory
  file: &default_file
    owner:  0
    group:  0
    mode:   '0644'

os::dirs:   # https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard
  etc:
    path:   '/etc'
    <<: *default_directory

    # TODO - define a YAML tag (eg. !lookup) and extend Ruby's YAML parser class
    # lookup() in Hiera/YAML parsing context MUST hide inside strings, so this does NOT work
    #<<: "%{lookup('os::default.directory')}"
    #
    # FIXME - this is more correct since it picks up overrides
    # owner:  "%{lookup('os::default.directory.owner')}"
    # group:  "%{lookup('os::default.directory.group')}"
    # mode:   "%{lookup('os::default.directory.mode')}"
  temp:
    path:   '/tmp'
    <<: *default_directory
    # Puppet 4.10 is till broken and demands string
    mode:   '01777'
  var:
    path:   '/var'
    <<: *default_directory
  state:
    path:   '/var/lib'
    <<: *default_directory
  log:
    path:   '/var/log'
    <<: *default_directory
  home:
    path:  '/home'
    <<: *default_directory
  opt: &opt
    path:   '/opt'
    <<: *default_directory
  3rdparty:
    <<: *opt
  local:
    path:   '/usr/local'
    <<: *default_directory
  mount:
    path:   '/mnt'
    <<: *default_directory
  media:
    path:   '/media'
    <<: *default_directory


os::files:
  password:
    path:   "%{lookup('os::dirs.etc')}/passwd"
    <<: *default_file
    # Puppet 4.10 is till broken and demands string
    mode:   '0644'
  shadow:
    path:   "%{lookup('os::dirs.etc')}/shadow"
    <<: *default_file
    mode:   '0640'

# Puppet 4.10 is till broken and demands string
os::umask:  '0022'


os::perms:
  directory: 0777
  file:     0666
  none:     0
  suid:     04000
  sgid:     02000
  sticky:   01000
  t:        01000
  exec:     01
  e:        01
  write:    02
  w:        02
  read:     04
  r:        04
  rx:       05
  rw:       06
  rwx:      07
  # shift << 6
  user:     0100
  u:        0100
  # shift << 3
  group:    010
  g:        010
  other:    01
  o:        01
  all:      0111

#DEPRECATED - just use Fact
#os::path: [ '/sbin', '/bin', '/usr/sbin', '/usr/bin' ]

os::users:
  root:
    name:   'root'
    uid:    0
    gid:    0
    groups: []
    home:   '/'
#    comment:
#    expire:
#    shell:

    # 'bin'   => 1,
    # 'daemon' => 2,
    # 'adm'   => 3,
    # 'lp'    => 4,
    # 'sync'  => 5,
    # 'shutdown' => 6,
    # 'halt'  => 7,
    # 'mail'  => 8,
    # 'uucp'  => 10,
    # 'nobody' => 99

os::uids:
  0:    'root'
  1:    'bin'

os::groups:
  root:
    gid: 0
    # various fields
    users: []
  bin:
    gid: 1
    users: ['bin', 'daemon']
  sys:
    gid: 3
    users: ['bin', 'adm']
    # 'adm'   => 4,    #:adm,daemon
    # 'tty'   => 5,
    # 'disk'  => 6,
    # 'lp'    => 7,    #:daemon
    # 'mem'   => 8,
    # 'kmem'  => 9,
    # 'wheel' => 10,
    # 'nobody' => 99,
    # 'users' => 100

os::gids:
  0:    'root'
  1:    'bin'
  2:    'daemon'
  3:    'sys'

os::package:
  suffix: .tar.gz
